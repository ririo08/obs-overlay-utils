import{i as v,ad as w,h as l,Z as x,af as C,ae as G,an as I,ao as Q,ap as _,ag as D}from"./gi-y3ZTb.js";function m(s){return C()?(G(s),!0):!1}const g=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;function O(s,o=1e3,p={}){const{immediate:y=!0,immediateCallback:f=!1}=p;let n=null;const e=x(!1);function i(){n&&(clearInterval(n),n=null)}function c(){e.value=!1,i()}function r(){const t=l(o);t<=0||(e.value=!0,f&&s(),i(),e.value&&(n=setInterval(s,t)))}if(y&&g&&r(),v(o)||typeof o=="function"){const t=w(o,()=>{e.value&&g&&r()});m(t)}return m(c),{isActive:e,pause:c,resume:r}}const d=new WeakMap;function T(s,o,p={}){const{mode:y="replace",route:f=I(),router:n=Q(),transform:e}=p;let i=u=>u,c=u=>u;typeof e=="function"?i=e:e&&(e.get&&(i=e.get),e.set&&(c=e.set)),d.has(n)||d.set(n,new Map);const r=d.get(n);let t=f.query[s];m(()=>{t=void 0});let h;const R=_((u,q)=>(h=q,{get(){return u(),i(t!==void 0?t:l(o))},set(a){a=c(a),t!==a&&(t=a===l(o)?void 0:a,r.set(s,a===l(o)?void 0:a),q(),D(()=>{if(r.size===0)return;const S=Object.fromEntries(r.entries());r.clear();const{params:k,query:b,hash:W}=f;n[l(y)]({params:k,query:{...b,...S},hash:W})}))}}));return w(()=>f.query[s],u=>{t!==i(u)&&(t=u,h())},{flush:"sync"}),R}export{T as a,O as u};
